<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Node å¼€å‘å®è·µ | ğŸ’«Viaã®blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/babe.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.795a5f26.css" as="style"><link rel="preload" href="/assets/js/app.1a8c5bfd.js" as="script"><link rel="preload" href="/assets/js/2.dec9ee96.js" as="script"><link rel="preload" href="/assets/js/12.13eb32e8.js" as="script"><link rel="prefetch" href="/assets/js/10.8be9e924.js"><link rel="prefetch" href="/assets/js/11.44f5bc5a.js"><link rel="prefetch" href="/assets/js/13.0b29cc16.js"><link rel="prefetch" href="/assets/js/14.a078733b.js"><link rel="prefetch" href="/assets/js/15.11a9ccdf.js"><link rel="prefetch" href="/assets/js/16.a2c3d2a9.js"><link rel="prefetch" href="/assets/js/17.980f556f.js"><link rel="prefetch" href="/assets/js/18.cea60c17.js"><link rel="prefetch" href="/assets/js/19.a727f28e.js"><link rel="prefetch" href="/assets/js/20.023d0896.js"><link rel="prefetch" href="/assets/js/21.fbabcbd6.js"><link rel="prefetch" href="/assets/js/22.13927ea0.js"><link rel="prefetch" href="/assets/js/23.a9bc2c2a.js"><link rel="prefetch" href="/assets/js/24.32925ff2.js"><link rel="prefetch" href="/assets/js/25.7aa0e1ed.js"><link rel="prefetch" href="/assets/js/26.ca27a143.js"><link rel="prefetch" href="/assets/js/27.8d248508.js"><link rel="prefetch" href="/assets/js/28.6d467f80.js"><link rel="prefetch" href="/assets/js/29.d0462958.js"><link rel="prefetch" href="/assets/js/3.425531bf.js"><link rel="prefetch" href="/assets/js/30.8b05a0c2.js"><link rel="prefetch" href="/assets/js/31.7b9ee93d.js"><link rel="prefetch" href="/assets/js/32.309cfa25.js"><link rel="prefetch" href="/assets/js/33.11c2341a.js"><link rel="prefetch" href="/assets/js/4.c0667068.js"><link rel="prefetch" href="/assets/js/5.cd04caea.js"><link rel="prefetch" href="/assets/js/6.22a02351.js"><link rel="prefetch" href="/assets/js/7.3a87c63c.js"><link rel="prefetch" href="/assets/js/8.7771a382.js"><link rel="prefetch" href="/assets/js/9.167ee458.js">
    <link rel="stylesheet" href="/assets/css/0.styles.795a5f26.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/babe.png" alt="ğŸ’«Viaã®blog" class="logo"> <span class="site-name can-hide">ğŸ’«Viaã®blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ReactğŸŒ´" class="dropdown-title"><span class="title">ReactğŸŒ´</span> <span class="arrow down"></span></button> <button type="button" aria-label="ReactğŸŒ´" class="mobile-dropdown-title"><span class="title">ReactğŸŒ´</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/reactCode.html" class="nav-link">
  åº•å±‚
</a></li><li class="dropdown-item"><!----> <a href="/pages/react.html" class="nav-link">
  å…¶ä»–
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic ğŸ³" class="dropdown-title"><span class="title">Basic ğŸ³</span> <span class="arrow down"></span></button> <button type="button" aria-label="Basic ğŸ³" class="mobile-dropdown-title"><span class="title">Basic ğŸ³</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/javascript.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/pages/css.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/pages/webpack.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/pages/flutter.html" class="nav-link">
  Flutter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web ğŸŒ" class="dropdown-title"><span class="title">Web ğŸŒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="Web ğŸŒ" class="mobile-dropdown-title"><span class="title">Web ğŸŒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/http.html" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/pages/browser.html" class="nav-link">
  æµè§ˆå™¨
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node â˜ï¸" class="dropdown-title"><span class="title">Node â˜ï¸</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node â˜ï¸" class="mobile-dropdown-title"><span class="title">Node â˜ï¸</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/node.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  node
</a></li><li class="dropdown-item"><!----> <a href="/pages/nest.html" class="nav-link">
  nest
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Blog âœğŸ»" class="dropdown-title"><span class="title">Blog âœğŸ»</span> <span class="arrow down"></span></button> <button type="button" aria-label="Blog âœğŸ»" class="mobile-dropdown-title"><span class="title">Blog âœğŸ»</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/log.html" class="nav-link">
  æ—¥å¸¸è®°å½•
</a></li><li class="dropdown-item"><!----> <a href="/pages/blog.html" class="nav-link">
  åšå®¢
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ReactğŸŒ´" class="dropdown-title"><span class="title">ReactğŸŒ´</span> <span class="arrow down"></span></button> <button type="button" aria-label="ReactğŸŒ´" class="mobile-dropdown-title"><span class="title">ReactğŸŒ´</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/reactCode.html" class="nav-link">
  åº•å±‚
</a></li><li class="dropdown-item"><!----> <a href="/pages/react.html" class="nav-link">
  å…¶ä»–
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic ğŸ³" class="dropdown-title"><span class="title">Basic ğŸ³</span> <span class="arrow down"></span></button> <button type="button" aria-label="Basic ğŸ³" class="mobile-dropdown-title"><span class="title">Basic ğŸ³</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/javascript.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/pages/css.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/pages/webpack.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/pages/flutter.html" class="nav-link">
  Flutter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web ğŸŒ" class="dropdown-title"><span class="title">Web ğŸŒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="Web ğŸŒ" class="mobile-dropdown-title"><span class="title">Web ğŸŒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/http.html" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/pages/browser.html" class="nav-link">
  æµè§ˆå™¨
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node â˜ï¸" class="dropdown-title"><span class="title">Node â˜ï¸</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node â˜ï¸" class="mobile-dropdown-title"><span class="title">Node â˜ï¸</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/node.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  node
</a></li><li class="dropdown-item"><!----> <a href="/pages/nest.html" class="nav-link">
  nest
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Blog âœğŸ»" class="dropdown-title"><span class="title">Blog âœğŸ»</span> <span class="arrow down"></span></button> <button type="button" aria-label="Blog âœğŸ»" class="mobile-dropdown-title"><span class="title">Blog âœğŸ»</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/log.html" class="nav-link">
  æ—¥å¸¸è®°å½•
</a></li><li class="dropdown-item"><!----> <a href="/pages/blog.html" class="nav-link">
  åšå®¢
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Node å¼€å‘å®è·µ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/node.html#node-å¼€å‘å®è·µ" class="sidebar-link">Node å¼€å‘å®è·µ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/node.html#node-åŸºç¡€æ¶æ„" class="sidebar-link">node åŸºç¡€æ¶æ„</a></li><li class="sidebar-sub-header"><a href="/pages/node.html#libuv-åˆ†ä¸¤éƒ¨åˆ†-handleã€request" class="sidebar-link">Libuv åˆ†ä¸¤éƒ¨åˆ† handleã€request</a></li><li class="sidebar-sub-header"><a href="/pages/node.html#commonjs-æ¨¡å—è§„èŒƒ" class="sidebar-link">commonJS æ¨¡å—è§„èŒƒ</a></li><li class="sidebar-sub-header"><a href="/pages/node.html#äº‹ä»¶å¾ªç¯-2" class="sidebar-link">äº‹ä»¶å¾ªç¯</a></li><li class="sidebar-sub-header"><a href="/pages/node.html#ç›‘å¬è¾“å…¥" class="sidebar-link">ç›‘å¬è¾“å…¥</a></li><li class="sidebar-sub-header"><a href="/pages/node.html#eventemitter-è§‚å¯Ÿè€…æ¨¡å¼-æŠ›äº‹ä»¶" class="sidebar-link">EventEmitter è§‚å¯Ÿè€…æ¨¡å¼ï¼ŒæŠ›äº‹ä»¶</a></li><li class="sidebar-sub-header"><a href="/pages/node.html#å›è°ƒ-callback" class="sidebar-link">å›è°ƒ callback</a></li><li class="sidebar-sub-header"><a href="/pages/node.html#express" class="sidebar-link">express</a></li><li class="sidebar-sub-header"><a href="/pages/node.html#koa" class="sidebar-link">koa</a></li><li class="sidebar-sub-header"><a href="/pages/node.html#rpc-è°ƒç”¨" class="sidebar-link">RPC è°ƒç”¨</a></li><li class="sidebar-sub-header"><a href="/pages/node.html#api" class="sidebar-link">api</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="node-å¼€å‘å®è·µ"><a href="#node-å¼€å‘å®è·µ" class="header-anchor">#</a> Node å¼€å‘å®è·µ</h2> <h3 id="node-åŸºç¡€æ¶æ„"><a href="#node-åŸºç¡€æ¶æ„" class="header-anchor">#</a> node åŸºç¡€æ¶æ„</h3> <p>ä¸‰éƒ¨åˆ†ï¼šLibuv(c è¯­è¨€),V8(JS å¼•æ“),C++<br>
å•çº¿ç¨‹+äº‹ä»¶é©±åŠ¨+éé˜»å¡ IO<br>
å•çº¿ç¨‹ï¼šä¸æ¨èä½¿ç”¨é˜»å¡ç±»å‹ api<br>
äº‹ä»¶é©±åŠ¨ï¼šå‘å¸ƒè®¢é˜…ï¼Œé€šçŸ¥ï¼Œäº‹ä»¶è§¦å‘ç±»å‹ï¼šæ°´å¹³è§¦å‘ã€è¾¹ç¼˜è§¦å‘
æ¥æ”¶ -&gt; çº¿ç¨‹æ± (å®Œæˆåé€šçŸ¥ç»™ç”Ÿäº§è€…\ä¸»çº¿ç¨‹) -&gt; ç”Ÿäº§è€…(ç”Ÿäº§ä¸€ä¸ªä»»åŠ¡åˆ°äº‹ä»¶å¾ªç¯ä¸­) -&gt; æ¶ˆè´¹è€… -&gt; å“åº”å›è°ƒ<br>
ä¾‹å¦‚ï¼š OS ç›¸å…³ api:
ç”¨æˆ·è°ƒç”¨ os.xxx ---&gt; node è°ƒç”¨ V8 çš„å¯¹åº”æ–¹æ³• ---&gt; V8 åº•å±‚è¯»å–ï¼Œç”± c++è½¬åŒ–ä¸º js ---&gt;return ç»™ node ---&gt; return ç»™ç”¨æˆ·</p> <h4 id="äº‹ä»¶å¾ªç¯"><a href="#äº‹ä»¶å¾ªç¯" class="header-anchor">#</a> äº‹ä»¶å¾ªç¯</h4> <p>æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œæ— ä»»åŠ¡æ—¶å¤„äºé˜»å¡çŠ¶æ€ï¼Œè¿›å…¥ä¸€ä¸ª promise ä¸­ç­‰å¾…ï¼Œä¸€æ—¦æœ‰ä»»åŠ¡å†è¢«å”¤èµ·</p> <h3 id="libuv-åˆ†ä¸¤éƒ¨åˆ†-handleã€request"><a href="#libuv-åˆ†ä¸¤éƒ¨åˆ†-handleã€request" class="header-anchor">#</a> Libuv åˆ†ä¸¤éƒ¨åˆ† handleã€request</h3> <h3 id="commonjs-æ¨¡å—è§„èŒƒ"><a href="#commonjs-æ¨¡å—è§„èŒƒ" class="header-anchor">#</a> commonJS æ¨¡å—è§„èŒƒ</h3> <p>CommonJS module.exports | require()
ESM export | import</p> <ol><li>webpack ç”¨æ¥è®² js æ–‡ä»¶æ¨¡å—åŒ–ï¼Œæ¯ä¸ªæ–‡ä»¶å³ä¸€ä¸ªå‡½æ•°ï¼Œåˆç‹¬ç«‹çš„ä½œç”¨åŸŸ</li> <li>export é»˜è®¤ä»¥å¯¹è±¡è¾“å‡º
js å†…å’Œå¤–éƒ¨æ˜¯åŒä¸€å¼•ç”¨ ---&gt; å¯åœ¨å¤–éƒ¨ require å¹¶é™„åŠ å±æ€§ä¸Šå»
module.exports = æŒ‡å®šæ–¹æ³•æˆ–å¯¹è±¡ å¯è¦†ç›–é»˜è®¤ export å¯¹è±¡</li></ol> <p>import dayjs from 'dayjs'; æŠ¥é”™<br>
TypeError: dayjs_1.default is not a function<br>
https://github.com/iamkun/dayjs/issues/475</p> <h3 id="äº‹ä»¶å¾ªç¯-2"><a href="#äº‹ä»¶å¾ªç¯-2" class="header-anchor">#</a> äº‹ä»¶å¾ªç¯</h3> <p>é˜»å¡å’Œéé˜»å¡åŒºåˆ«ï¼šç³»ç»Ÿåœ¨è¾“å…¥åˆ°è¾“å‡ºæœŸé—´èƒ½å¦æ¥å—å…¶ä»–è¾“å…¥ã€‚
<img src="/assets/img/node-eventloop.24e43aa1.jpg" alt="eventloop" title="äº‹ä»¶å¾ªç¯"></p> <h3 id="ç›‘å¬è¾“å…¥"><a href="#ç›‘å¬è¾“å…¥" class="header-anchor">#</a> ç›‘å¬è¾“å…¥</h3> <h3 id="eventemitter-è§‚å¯Ÿè€…æ¨¡å¼-æŠ›äº‹ä»¶"><a href="#eventemitter-è§‚å¯Ÿè€…æ¨¡å¼-æŠ›äº‹ä»¶" class="header-anchor">#</a> EventEmitter è§‚å¯Ÿè€…æ¨¡å¼ï¼ŒæŠ›äº‹ä»¶</h3> <p>æœ‰æ— è®¢é˜…éƒ½èƒ½ç»§ç»­ï¼Œä¸å—è¢«é€šçŸ¥è€…å½±å“ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">NewEventListener</span> <span class="token keyword">extends</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;newSomething&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">sth</span><span class="token operator">:</span> <span class="token string">&quot;some attribution&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> newListener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NewEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

newListener<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">&quot;newSomething&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;yeah~&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {sth:'some attribution'}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å›è°ƒ-callback"><a href="#å›è°ƒ-callback" class="header-anchor">#</a> å›è°ƒ callback</h3> <p>node ä¸­ try catch<br>
æ¯ä¸ªäº‹ä»¶å¾ªç¯éƒ½æ˜¯æ–°çš„è°ƒç”¨æ ˆ</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">interview</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">// æ–°çš„è°ƒç”¨æ ˆ</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// throw new Error('fail');   // æ‰€ä»¥åŸä¸Šå±‚è°ƒç”¨æ ˆï¼Œcatchä¸åˆ°</span>
      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'fail'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token comment">// æ‰€ä»¥éœ€è¦callback æŠ›å›å»</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// try{</span>
  <span class="token function">interview</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// node è§„èŒƒå¼‚æ­¥æ–¹æ³•å›è°ƒç¬¬ä¸€ä¸ªå‚æ•°ä¸º Error</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'cry'</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'smile'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// } catch (e) {</span>
<span class="token comment">//   console.log('cry',e);</span>
<span class="token comment">// }</span>
</code></pre></div><p>å¼Šç«¯ï¼šå›è°ƒåœ°ç‹±ï¼Œå¼‚æ­¥å¹¶å‘<br>
å¼‚æ­¥å¹¶å‘è§£å†³ï¼šasyncjs,thunk</p> <h3 id="express"><a href="#express" class="header-anchor">#</a> express</h3> <ol><li>æä¾›äº†è·¯ç”±ã€http é‡å®šå‘ç­‰åŠŸèƒ½
app.get('è·¯ç”±',function(req,res,next){})</li> <li>åŒæ­¥ä¸­é—´ä»¶ ç¬¦åˆæ´‹è‘±æ¨¡å‹ï¼Œä½†æ˜¯ next()æ˜¯é˜»å¡çš„ï¼Œæ—  context</li></ol> <h3 id="koa"><a href="#koa" class="header-anchor">#</a> koa</h3> <ol><li>ä¸­é—´ä»¶ å¼‚æ­¥ï¼Œæ”¯æŒ async awaitï¼Œæä¾› context</li> <li>ä¸æä¾›è·¯ç”±ï¼Œç”¨æˆ·è‡ªå®šä¹‰è·¯ç”±ä¸­é—´ä»¶å¤„ç†</li></ol> <h3 id="rpc-è°ƒç”¨"><a href="#rpc-è°ƒç”¨" class="header-anchor">#</a> RPC è°ƒç”¨</h3> <p>æœåŠ¡å™¨ä¹‹é—´çš„é€šè®¯ï¼Œå’Œ ajax åŒºåˆ«ï¼š</p> <ol><li>ä¸ä¸€å®šä½¿ç”¨ DNS è¿›è¡Œå¯»å€<br>
ajax:ä½¿ç”¨ DNS å¯»å€<br>
RPCï¼šä½¿ç”¨ç‰¹æœ‰æœåŠ¡è¿›è¡Œå¯»å€</li> <li>åº”ç”¨å±‚åè®®ä¸€èˆ¬ä¸ä½¿ç”¨ httpï¼Œä½¿ç”¨äºŒè¿›åˆ¶åè®®<br>
äºŒè¿›åˆ¶åè®®ç‰¹ç‚¹ï¼š[0110010101001010111110011]äºŒè¿›åˆ¶æµï¼Œä¸åŒä½æ•°ä»£è¡¨ä¸åŒå­—æ®µ</li></ol> <ul><li>æ•°æ®åŒ…ä½“ç§¯æ›´å°</li> <li>æ›´å¿«è§£ç é€Ÿç‡</li></ul> <ol start="3"><li>åŸºäº TCP æˆ– UDP åè®®<br>
TCP é€šè®¯æ–¹å¼ï¼šå•å·¥é€šè®¯ã€åŠåŒå·¥é€šè®¯ï¼ˆè½®ç•ªå•å·¥ï¼‰ã€å…¨åŒå·¥é€šè®¯</li></ol> <h4 id="buffer"><a href="#buffer" class="header-anchor">#</a> Buffer</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> buf1 <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;sadf&quot;</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åˆ›å»ºbuffer</span>

<span class="token keyword">const</span> buf2 <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æŒ‡å®šé•¿åº¦åˆ›å»ºç©ºbuffer</span>

buf2<span class="token punctuation">.</span><span class="token function">writeInt8</span><span class="token punctuation">(</span>æ•°å­—<span class="token punctuation">,</span> åç§»é‡<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å°†æ•°å­—ä»¥8ä½å†™å…¥bufferä¸­ï¼Œç”¨äºç¼–ç ä¸€ä¸ªäºŒè¿›åˆ¶åŒ…</span>

<span class="token comment">// protocal-buffers é…ç½®åè®®æ–‡ä»¶ï¼Œå°†ä¼ å…¥çš„JSONæ•°æ®è‡ªåŠ¨ç”Ÿæˆã€è§£æäºŒè¿›åˆ¶åŒ…</span>
</code></pre></div><h4 id="net-æ­å»ºå¤šè·¯å¤ç”¨çš„-rpc-é€šé“"><a href="#net-æ­å»ºå¤šè·¯å¤ç”¨çš„-rpc-é€šé“" class="header-anchor">#</a> net æ­å»ºå¤šè·¯å¤ç”¨çš„ RPC é€šé“</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ==========================å•å·¥é€šä¿¡============================</span>
<span class="token comment">// å•æ–¹å†™å…¥</span>
<span class="token comment">// ----------------server.js</span>
<span class="token keyword">const</span> net <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'net'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> net<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span>buffer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span>

<span class="token comment">// ----------------client.js</span>
<span class="token keyword">const</span> net <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'net'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">net<span class="token punctuation">.</span>Socket</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
socket<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">;</span>
  <span class="token literal-property property">port</span><span class="token operator">:</span><span class="token string">'4000'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
socket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span>

<span class="token comment">// ==========================åŠåŒå·¥é€šä¿¡============================</span>
<span class="token comment">// æ¥å›é€šè®¯</span>
<span class="token comment">// ----------------server.js</span>
<span class="token keyword">const</span> net <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'net'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">111</span><span class="token operator">:</span><span class="token string">'01: æ˜¥å¤©'</span><span class="token punctuation">,</span>
  <span class="token number">222</span><span class="token operator">:</span><span class="token string">'02: å¤å¤©'</span><span class="token punctuation">,</span>
  <span class="token number">333</span><span class="token operator">:</span><span class="token string">'03: ç§‹å¤©'</span><span class="token punctuation">,</span>
  <span class="token number">444</span><span class="token operator">:</span><span class="token string">'04: å†¬å¤©'</span><span class="token punctuation">,</span>
  <span class="token number">555</span><span class="token operator">:</span><span class="token string">'05: æ˜¥å¤©'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> net<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> buffer<span class="token punctuation">.</span><span class="token function">readInt16BE</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    buffer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">//è¿”å›å¯¹åº”çš„å€¼</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span>

<span class="token comment">// ----------------client.js</span>
<span class="token keyword">const</span> net <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'net'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">net<span class="token punctuation">.</span>Socket</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
socket<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">;</span>
  <span class="token literal-property property">port</span><span class="token operator">:</span><span class="token string">'4000'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
socket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span>

<span class="token comment">// ==========================å…¨åŒå·¥é€šä¿¡============================</span>
<span class="token comment">/*
å¯èƒ½å­˜åœ¨çš„é—®é¢˜
1. è¯·æ±‚å“åº”ä¸å¯¹åº”
éœ€è¦æ‰‹åŠ¨æ‹¼æ¥ä¸€ä¸ªå­—æ®µæ ‡è®°åŒ…å·
2. åŒæ—¶å‘é€å¾ˆå¤šåŒ… TCPä¼šå°†æ•°æ®åˆå¹¶å‘é€(ä¼˜åŒ–æœºåˆ¶)ï¼Œé€ æˆç²˜åŒ…
éœ€è¦æ‰‹åŠ¨åˆ†å‰²ï¼Œæ ‡è®°åŒ…é•¿
3. ç½‘ç»œé”™è¯¯å¤„ç†
*/</span>


</code></pre></div><h3 id="api"><a href="#api" class="header-anchor">#</a> api</h3> <p><strong>path</strong><br>
path.resolve() ä»æ ¹ç›®å½•æ‹¼æ¥ï¼ˆç»å¯¹è·¯å¾„ï¼‰
path.join() å•çº¯æ‹¼æ¥</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">8/3/2023, 5:47:49 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1a8c5bfd.js" defer></script><script src="/assets/js/2.dec9ee96.js" defer></script><script src="/assets/js/12.13eb32e8.js" defer></script>
  </body>
</html>
